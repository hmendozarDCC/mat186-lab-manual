---
title: "Lab 17: Linear Regression"
author: "MAT186: Introduction to Data Science"
date-modified: last-modified
params:
  dataset: "data/2026_Fall/lbw.csv"
---

## Learning Objectives
* Understand the Linear Regression equation: $y = \beta_0 + \beta_1x + \epsilon$.
* Calculate and interpret the **Correlation Coefficient ($r$)**.
* Fit a Linear Model in R using the `lm()` function.
* Evaluate model fit using **R-squared ($R^2$)**.

---

::: {.callout-note}
## Data Acquisition: Birth Weight Dataset (lbw.csv)
To complete the regression exercises, you need the `lbw.csv` dataset. Choose **one** of the methods below to load the data into R.
:::

::: {.panel-tabset}

## Option 1: Direct Link (Recommended)
This method pulls the data directly from the lab manual website.

```r
# Load data directly from the web
url <- "[https://hmendozardcc.github.io/mat186-lab-manual/data/2026_Fall/lbw.csv](https://hmendozardcc.github.io/mat186-lab-manual/data/2026_Fall/lbw.csv)"
data <- read.csv(url)

# View the first few rows to confirm it loaded
head(data)

```
## Option 2: Local File
Use this if the file is saved in your project folder.
```r
# Load data from your local data folder
data <- read.csv("data/lbw.csv")
head(data)
```




---
## Part 1: Correlation ($r$)
Before building a model, we need to know if a linear relationship even exists. The correlation coefficient ($r$) ranges from **-1** to **1**.
* **1**: Perfect positive relationship.
* **0**: No relationship at all.
* **-1**: Perfect negative relationship.

```r
library(tidyverse)

# Calculate correlation between Mother's Weight (lwt) and Birth Weight (bwt)
data |>
  drop_na(lwt, bwt) |>
  summarize(correlation = cor(lwt, bwt))
```



---

## Part 2: Visualizing the Best Fit Line
We use `geom_smooth(method = "lm")` to draw the line that minimizes the distance between all data points (the "Ordinary Least Squares" method).

```r
#| label: fig-regression
#| fig-cap: "Regression of Birth Weight on Mother's Weight"
#| fig-alt: "Scatter plot showing a positive trend between mother's weight and infant birth weight with a blue regression line."

ggplot(data, aes(x = lwt, y = bwt)) +
  geom_point(alpha = 0.5, color = "#002147") + # DCC Navy
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  theme_minimal() +
  labs(title = "Predicting Birth Weight based on Mother's Weight",
       x = "Mother's Weight (lbs)",
       y = "Birth Weight (grams)")
```



---

## Part 3: Building the Model in R
In R, the "Linear Model" function is `lm()`. The syntax is `lm(dependent_variable ~ independent_variable)`.

```r
# 1. Create the model
lbw_model <- lm(bwt ~ lwt, data = data)

# 2. View the results
summary(lbw_model)
```

### How to interpret the summary:
* **Intercept ($\beta_0$):** The predicted value of $y$ when $x$ is zero.
* **Slope ($\beta_1$):** For every 1 unit increase in $x$, how much $y$ is expected to change.
* **R-squared ($R^2$):** The percentage of variation in $y$ explained by your model. (e.g., $0.75$ means your model explains 75% of the data).

---

## Part 4: Making Predictions
Once you have a model, you can plug in a value for $x$ to predict $y$. If our model is $Mass = -100 + 1.2(Height)$, we can predict the mass of a character who is 200cm tall.

```r
# Predict birth weight for a mother weighing 150 lbs
new_mom <- data.frame(lwt = 150)
predict(lbw_model, newdata = new_mom)
```
::: {.callout-tip}

**Lab Task 17:**
1. Pick two numeric variables from your dataset that you think are related.

2. Create a **Scatter Plot** and add a linear regression line.

3. Use the `cor()` function to find the correlation coefficient.

4. Fit a linear model using `lm()` and look at the `summary()`.

5. **The Report:**
   * What is the slope of your model? 
   * What is the $R^2$ value? 
   * Use your model to make one prediction for a value not in your dataset.
:::

::: {.content-visible when-profile="solution"}


# Task 1 and 2: Scatter Plot and a linear regression line.
```r
# 1. Load the library
library(tidyverse)

# 2. Create the plot
# x = Independent variable (Mother's weight in lbs)
# y = Dependent variable (Infant birth weight in grams)
ggplot(data, aes(x = lwt, y = bwt)) +
  geom_point(alpha = 0.6, color = "#002147") +  # DCC Navy points
  geom_smooth(method = "lm", color = "red", se = TRUE) + # Regression line with error shading
  theme_light() +
  labs(
    title = "Relationship Between Maternal Weight and Birth Weight",
    subtitle = "Data source: Low Birth Weight (LBW) Dataset",
    x = "Mother's Weight (lbs)", 
    y = "Infant Birth Weight (grams)",
    caption = "The red line represents the linear regression model."
  )
```       
# Task 3: Correlation
cor(data$age, data$bwt)




# Task 4: Model
task_model <- lm(bwt ~ age, data = data)
summary(task_model)
:::



---

## Pro-Tip: Correlation $\neq$ Causation
Just because mother's weight and birth weight are mathematically related doesn't mean weight is the only factor. Other variables like smoking status or clinical history play a major role!
