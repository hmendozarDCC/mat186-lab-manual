# Lab 14: Bootstrapping and Resampling

## Learning Objectives
* Understand the concept of **Sampling with Replacement**.
* Use the `infer` package to create a bootstrap distribution.
* Estimate a **Confidence Interval** without assuming the data is "Normal."
* Compare Bootstrap results to traditional T-test results.

---

## Introduction: Pulling yourself up by your Boots
What if your data is skewed, or you have a very small sample size? Traditional math might fail you. **Bootstrapping** solves this by treating your sample like a "mini-population." We take thousands of samples from our own data to see how much the mean varies.



---

## Part 1: The `infer` Package
In R, the `infer` package makes the logic of bootstrapping very clear. We follow four steps: `specify`, `generate`, `calculate`, and `visualize`.

```{r}
# Install and load the infer package
if(!require(infer)) install.packages("infer")
library(tidyverse)
library(infer)

# Let's bootstrap the mean height of Star Wars characters
boot_dist <- starwars |>
  drop_na(height) |>
  specify(response = height) |>              # 1. What variable?
  generate(reps = 1000, type = "bootstrap") |> # 2. Resample 1000 times
  calculate(stat = "mean")                   # 3. Find the mean each time

#| label: tbl-boot-head
#| tbl-cap: "The first six rows of the bootstrap distribution, showing the calculated mean for each simulation replicate."

head(boot_dist) |>
  knitr::kable()
```

---

## Part 2: Visualizing the Bootstrap Distribution
Instead of a theoretical curve, we look at the actual distribution of our 1,000 "fake" means.

```{r}
#| label: fig-visualize-bootstrap
#| fig-cap: "Bootstrap distribution of mean heights for Star Wars characters based on 1,000 resamples."
#| fig-alt: "A histogram showing the distribution of 1,000 bootstrap sample means. The distribution is symmetric and bell-shaped, centered at approximately 174 cm. This visualization represents the sampling variability of the mean height. The x-axis shows the sample mean height in cm, and the y-axis shows the frequency of those means."
#| warning: false
#| message: false

visualize(boot_dist) +
  labs(title = "Bootstrap Distribution of the Mean",
       x = "Sample Mean Height (cm)", 
       y = "Count")
```



---

## Part 3: The Percentile Method
To find a 95% Confidence Interval, we simply look at where the middle 95% of our 1,000 bootstrap means fall.

```{r}
#| label: tbl-bootstrap-ci
#| tbl-cap: "95% Confidence Interval for mean height using the Percentile Method (1,000 bootstrap replicates)."

# 1. Calculate the interval
percentile_ci <- boot_dist |>
  get_confidence_interval(level = 0.95, type = "percentile")

# 2. Present as an accessible table
knitr::kable(
  percentile_ci,
  col.names = c("Lower Bound (2.5%)", "Upper Bound (97.5%)"),
  digits = 2
)
```

---

## Part 4: Why Use Bootstrapping?
1. **No "Normality" Required:** It works even if your data is weirdly shaped.
2. **Any Statistic:** You can bootstrap the mean, the median, the standard deviation, or even the correlation coefficient.
3. **Visual Logic:** It helps you *see* the uncertainty in your estimate.

---

<div class="dcc-important">
**Lab Task 14:**

1. Pick a numeric variable from your dataset.
2. Create a histogram of the original data. (Is it skewed?)
3. Run the `infer` code above to generate 1,000 bootstrap reps for the **Median** instead of the mean (`stat = "median"`).
4. Visualize the bootstrap distribution.
5. Calculate the 95% Confidence Interval. 
6. **Reflection:** In your Quarto document, explain in your own words why we "sample with replacement" during bootstrapping.
</div>

---

::: {.callout-tip}
### Done with the Lab?
If you have finished all the tasks above, you can verify your work against the official solutions.

<center>
<a href="../solutions.html" class="btn btn-outline-success" role="button">ðŸ”“ Access Lab Solutions</a>
</center>
:::

