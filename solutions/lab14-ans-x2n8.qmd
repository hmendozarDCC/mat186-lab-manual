---
title: "Solution - Lab 14: Bootstrapping"
subtitle: "MAT 186: Introduction to Data Science"
format:
  html:
    toc: true
    toc-location: right
---

<script>
  var password = "MAT186LABSOER";
  var res = prompt("DCC Instructor Key Required:");
  if (res != password) {
    alert("Incorrect password. Access denied.");
    window.location.href = "../index.html";
  }
</script>

## Bootstrapping - Official Solutions
To solve Lab 14, we focus on Bootstrapping, a powerful non-parametric method for estimating the uncertainty of a statistic (like the Median) without assuming the data is normally distributed.
::: {.callout-note}
### Instructor Note
Add your specific DCC lab answers below this box.
:::
## Lab 14 Official Solutions: Resampling Methods

In this lab, we use the `infer` package to estimate the 95% confidence interval for the median enrollment in the SUNY system using bootstrapping.

### Task 1: Loading and Preparing Data
We load the necessary libraries and clean our numeric variable by removing commas from the "Total Enrollment" column.

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(infer) # Used for bootstrapping

# Load the data
ny_data <- read_csv("../data/race_ny.csv")

# Clean numeric variable
clean_data <- ny_data |>
  mutate(total_enroll = as.numeric(gsub(",", "", `Total Enrollment`))) |>
  filter(!is.na(total_enroll))
```


### Task 2: Initial Visualization
Before bootstrapping, we examine the original distribution of the data.

```{r}
#| label: fig-original-hist
#| fig-cap: "Histogram of the original SUNY enrollment data."
#| fig-alt: "A histogram showing that the original enrollment data is highly right-skewed, with many small campuses and a few very large ones."
ggplot(clean_data, aes(x = total_enroll)) +
  geom_histogram(fill = "steelblue", color = "white", bins = 15) +
  labs(title = "Original Enrollment Distribution",
       x = "Total Students",
       y = "Count") +
  theme_minimal()
```


**Observation:** The original data is strongly right-skewed. Because the distribution is not symmetrical, the Median is a better measure of the "typical" enrollment than the Mean.

### Task 3 & 4: Generating and Visualizing the Bootstrap Distribution
We use the infer pipeline to generate 1,000 bootstrap replicates of the median.
```{r}
#| label: bootstrap-median
# 1. Specify the variable
# 2. Generate 1,000 resamples with replacement
# 3. Calculate the median for each resample
set.seed(123)
boot_dist <- clean_data |>
  specify(response = total_enroll) |>
  generate(reps = 1000, type = "bootstrap") |>
  calculate(stat = "median")

# Visualize the bootstrap distribution
#| label: fig-boot-dist
#| fig-cap: "Distribution of 1,000 bootstrap medians."
#| fig-alt: "A histogram showing the distribution of the calculated medians from 1,000 bootstrap samples. The distribution is much more symmetrical and bell-shaped than the original data."
visualize(boot_dist) +
  labs(title = "Bootstrap Distribution of the Median",
       x = "Bootstrap Median Enrollment",
       y = "Frequency") +
  theme_minimal()
```

### Task 5: Calculating the 95% Confidence Interval
We calculate the lower and upper bounds of our estimate using the percentile method.
```{r}
#| label: calc-ci
# Calculate the 95% Confidence Interval
percentile_ci <- boot_dist |>
  get_confidence_interval(level = 0.95, type = "percentile")

percentile_ci
```

### Task 6: Reflection
Why do we "sample with replacement" during bootstrapping?

We sample with replacement because we are treating our original sample as a "pseudo-population." By allowing the same observation to be picked more than once (or not at all) in a single bootstrap resample, we simulate the natural variation that would occur if we were able to take many new independent samples from the actual entire population. Without replacement, every resample would simply be identical to the original dataset, and we would have no way to measure the uncertainty of our statistic.


<br><br>

***

::: {.content-block}
<center>
<a href="../solutions.html" class="btn btn-primary btn-lg" role="button">üè† Back to Solutions Hub</a>
</center>
:::

